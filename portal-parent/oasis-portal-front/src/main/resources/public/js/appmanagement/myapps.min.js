var MyApps=React.createClass({displayName:"MyApps",getInitialState:function(){return{loading:!0,authorities:[]}},componentDidMount:function(){$.ajax({url:apps_service+"/authorities",dataType:"json",success:function(data){this.setState({loading:!1,authorities:data})}.bind(this),error:function(xhr,status,err){}.bind(this)})},render:function(){if(this.state.loading)return React.createElement("p",{className:"text-center"},React.createElement("i",{className:"fa fa-spinner fa-spin"})," ",t("ui.loading"));var auths=this.state.authorities.map(function(auth){return React.createElement(Authority,{name:auth.name,key:auth.id,id:auth.id,openByDefault:"INDIVIDUAL"==auth.type})});return React.createElement("div",{className:"container panel-group"},auths)}}),Authority=React.createClass({displayName:"Authority",getInitialState:function(){return{open:this.props.openByDefault}},toggle:function(){this.setState({open:!this.state.open})},render:function(){var content;return content=this.state.open?React.createElement(InstanceList,{id:this.props.id,name:this.props.name,authority:this.props.id}):null,React.createElement("div",{className:"panel panel-default"},React.createElement("div",{className:"panel-heading"},React.createElement("h4",{className:"panel-title",onClick:this.toggle},React.createElement("span",null,this.props.name),React.createElement(OpenAuthority,{callback:this.toggle,open:this.state.open}))),React.createElement("div",{ref:"content"},content))}}),OpenAuthority=React.createClass({displayName:"OpenAuthority",click:function(){this.props.callback()},render:function(){var className=this.props.open?"caret":"caret inverse";return React.createElement("a",{className:"authority-link pull-right",onClick:this.click},React.createElement("b",{className:className}))}}),InstanceList=React.createClass({displayName:"InstanceList",getInitialState:function(){return{loading:!0,instances:[]}},componentDidMount:function(){this.reloadInstances()},reloadInstances:function(){this.setState(this.getInitialState()),$.ajax({url:apps_service+"/instances/"+this.props.id,dataType:"json",success:function(data){this.setState({loading:!1,instances:data})}.bind(this),error:function(xhr,status,err){}.bind(this)})},componentDidUpdate:function(){$(this.getDOMNode()).toggle("blind")},render:function(){if(this.state.loading)return React.createElement("p",{className:"text-center"},React.createElement("i",{className:"fa fa-spinner fa-spin"})," ",t("ui.loading"));var instances=this.state.instances,authority=this.props.authority,reload=this.reloadInstances,result=0!=instances.length?instances.map(function(instance){return React.createElement(Instance,{key:instance.id,id:instance.id,instance:instance,authority:authority,reload:reload})}):React.createElement("div",{className:"text-center"},React.createElement("span",null,t("none")," "),React.createElement("b",null,this.props.name));return React.createElement("div",{className:"panel collapse"},result)}}),Instance=React.createClass({displayName:"Instance",manageUsers:function(event){event.preventDefault(),this.refs.users.init(),this.refs.manageUsers.open()},saveUsers:function(){this.refs.manageUsers.close(),$.ajax({url:apps_service+"/users/instance/"+this.props.id,dataType:"json",contentType:"application/json",type:"post",data:JSON.stringify(this.refs.users.getSelectedUsers()),error:function(xhr,status,err){}.bind(this)})},loadUsers:function(callback,error){$.ajax({url:apps_service+"/users/instance/"+this.props.id,dataType:"json",method:"get",success:callback,error:function(xhr,status,err){void 0!=error&&error()}.bind(this)})},queryUsers:function(query,callback){$.ajax({url:apps_service+"/users/network/"+this.props.authority+"?q="+query,dataType:"json",method:"get",success:callback,error:function(xhr,status,err){}.bind(this)})},componentDidMount:function(){$("a.tip",this.getDOMNode()).tooltip()},deprovision:function(){$.ajax({url:apps_service+"/deprovision/"+this.props.id,type:"post",success:function(){this.props.reload()}.bind(this),error:function(xhr,status,err){}.bind(this)})},render:function(){var manageUsersButton=null;"INDIVIDUAL:"!==this.props.authority.slice(0,"INDIVIDUAL:")&&(manageUsersButton=React.createElement("a",{className:"tip btn btn-default pull-right",href:"#",onClick:this.manageUsers,"data-toggle":"tooltip","data-placement":"bottom",title:t("manage_users")},React.createElement("li",{className:"fa fa-user"})));var instance=this.props.id,services=this.props.instance.services.map(function(service){return React.createElement(Service,{key:service.service.id,service:service,instance:instance})}),deprovision=null;return devmode&&(deprovision=React.createElement("a",{className:"btn btn-danger pull-right",href:"#",onClick:this.deprovision},t("ui.delete"))),React.createElement("div",{className:"panel panel-instance"},React.createElement(Modal,{ref:"manageUsers",title:t("manage_users"),successHandler:this.saveUsers},React.createElement(UserPicker,{ref:"users",users:this.loadUsers,source:this.queryUsers})),React.createElement("div",{className:"panel-heading"},React.createElement("img",{height:"32",width:"32",alt:this.props.instance.name,src:this.props.instance.icon}),React.createElement("span",{className:"appname"},this.props.instance.name),manageUsersButton,deprovision),React.createElement("div",{className:"panel-body"},React.createElement("div",{className:"standard-form"},React.createElement("div",{className:"row form-table-header"},React.createElement("div",{"class":"col-sm-10"},t("services"))),services)))}});React.renderComponent(React.createElement(MyApps,null),document.getElementById("myapps"));