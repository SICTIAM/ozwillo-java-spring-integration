var CreateOrganization=React.createClass({displayName:"CreateOrganization",componentDidMount:function(){$(this.refs.modal.getDOMNode()).on("shown.bs.modal",function(){$("input",this).first().focus()})},show:function(){this.refs.form.init(),this.refs.modal.open()},close:function(){this.refs.modal.close(),this.props.successHandler&&this.props.successHandler()},saveOrganization:function(){this.refs.form.saveOrganization()},render:function(){var buttonLabels={cancel:t("ui.cancel"),save:t("create")};return React.createElement("div",null,React.createElement(Modal,{ref:"modal",title:t("find-or-create-organization"),successHandler:this.saveOrganization,buttonLabels:buttonLabels},React.createElement(CreateOrganizationForm,{ref:"form",successHandler:this.close})))}}),CreateOrganizationForm=React.createClass({displayName:"CreateOrganizationForm",init:function(){this.setState(this.getInitialState())},getInitialState:function(){var type="";return this.props.typeRestriction&&(this.props.typeRestriction.company?this.props.typeRestriction.public_body||(type="COMPANY"):type="PUBLIC_BODY"),{organization:{name:"",type:type,territory_id:null},errors:[],saving:!1}},saveOrganization:function(event){if(event&&event.preventDefault(),!this.state.saving){var org=this.state.organization,errors=[];""==org.name.trim()&&errors.push("name"),""==org.type.trim()&&errors.push("type"),0==errors.length?(this.state.saving=!0,this.setState(this.state),$.ajax({url:network_service+"/create-organization",type:"post",contentType:"application/json",data:JSON.stringify(this.state.organization),success:function(data){this.props.successHandler&&this.props.successHandler(data)}.bind(this),error:function(xhr,status,err){var state=this.state;state.errors=["general"],state.saving=!1,this.setState(state)}.bind(this)})):(this.state.errors=errors,this.setState(this.state))}},changeInput:function(fieldname){return function(event){var org=this.state.organization;org[fieldname]=event.target.value,this.setState({organization:org,errors:[],saving:!1})}.bind(this)},toggleType:function(event){var org=this.state.organization;org.type=event.target.value,this.setState({organization:org,errors:[],saving:!1})},renderType:function(){var r=this.props.typeRestriction?this.props.typeRestriction:{company:!0,public_body:!0},public_body=null;r.public_body&&(public_body=React.createElement("div",{className:"radio"},React.createElement("label",null,React.createElement("input",{type:"radio",value:"PUBLIC_BODY",checked:"PUBLIC_BODY"==this.state.organization.type,onChange:this.toggleType},t("organization-type.PUBLIC_BODY")))));var company=null;r.company&&(company=React.createElement("div",{className:"radio"},React.createElement("label",null,React.createElement("input",{type:"radio",value:"COMPANY",checked:"COMPANY"==this.state.organization.type,onChange:this.toggleType},t("organization-type.COMPANY")))));var typeClassName=-1!=$.inArray("type",this.state.errors)?"error":"";return React.createElement("div",{className:"form-group"},React.createElement("label",{htmlFor:"organization-type",className:typeClassName},t("organization-type")),public_body,company)},render:function(){var nameClassName=-1!=$.inArray("name",this.state.errors)?"error":"",errorMessage=-1!=$.inArray("general",this.state.errors)?React.createElement("p",{className:"alert alert-danger",role:"alert"},t("ui.general-error")):null;return React.createElement("form",{onSubmit:this.saveOrganization},React.createElement("div",{className:"form-group"},React.createElement("label",{htmlFor:"organization-name",className:nameClassName},t("organization-name")),React.createElement("input",{type:"text",className:"form-control",value:this.state.organization.name,onChange:this.changeInput("name"),placeholder:t("organization-name")})),this.renderType(),React.createElement("div",{className:"form-group",style:devmode?{}:{display:"none"}},React.createElement("label",{htmlFor:"organization-territory_id",className:nameClassName},t("ui.location")),React.createElement(GeoSingleSelect2Component,{className:"form-control",ref:"territoryId",onChange:this.changeInput("territory_id"),name:"organization-territory_id"})),errorMessage)}});