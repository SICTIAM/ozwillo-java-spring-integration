<div data-th-fragment="layout (layout)">

  <div class="row" data-th-id="${layout.id}">
    <div class="col-sm-2 form-toggle-block">
        <button data-th-data="${layout.id}" type="button"
            data-th-class="'btn btn-form-toggle btn-view' + ${'VIEW'.equals(layout.mode.toString()) ? ' active' : ''}" 
            data-th-text="#{${layout.label}}">Identity</button>
        <button data-th-data="${layout.id}" type="button"
            data-th-class="'btn btn-form-toggle btn-edit' + ${'EDIT'.equals(layout.mode.toString()) ? ' active' : ''}">
            <span class="edit"></span><span data-th-text="#{ui.edit}">Edit</span>
        </button>
    </div>
    <div class="col-sm-10 form-data-block">
    <form data-th-class="'form-horizontal personal-data-form' + ${'EDIT'.equals(layout.mode.toString()) ? ' edit' : ''}"
        role="form" action="/my/profile/save" data-th-data="${layout.id}">
      <div data-th-each="widget: ${layout.widgets}" class="form-group">
          <label data-th-for="${widget.id}" class="col-sm-2 control-label" data-th-text="#{${widget.label}}">First name :</label>
          <div class="col-sm-10" data-th-if="${'text'.equals(widget.type)}"
                data-th-include="includes/my-profile-fragments :: text-widget (${widget}, ${layout.mode})">?</div>
      </div>
      <div class="form-group" data-th-if="${'EDIT'.equals(layout.mode.toString())}">
        <label class="col-sm-2 control-label"></label>
        <div class="col-sm-10">
            <input type="hidden" name="layout-id" data-th-value="${layout.id}" />
            <input type="submit" class="btn btn-save" data-th-value="#{ui.save}" />
        </div>
      </div>
    </form>
    </div>
  </div>

</div>

<div data-th-fragment="text-widget (widget, mode)">
    <input data-th-if="${'EDIT'.equals(mode.toString())}" type="text" class="form-control" data-th-name="${widget.id}" data-th-value="${widget.value}" />
    <span data-th-if="${'VIEW'.equals(mode.toString())}" class="form-value" data-th-text="${widget.value}">?</span>
</div>